# Fail2ban filter for WPFleet WordPress installations
# Detects brute force attacks on WordPress login and XML-RPC

[Definition]

# WordPress login failures
failregex = ^<HOST> .* "POST .*/(wp-login\.php|xmlrpc\.php).* (403|401)
            ^<HOST> .* "POST .*/wp-admin/.* 403
            ^<HOST> .* "POST .*/wp-json/wp/v2/users.* 401

# WordPress scanning attempts
            ^<HOST> .* "(GET|POST) .*/wp-config\.php
            ^<HOST> .* "(GET|POST) .*/\.env
            ^<HOST> .* "(GET|POST) .*/readme\.html

# Multiple 404s in short time (scanning)
            ^<HOST> .* "(GET|POST) .* 404.*" repeated 10 times

ignoreregex =
